---
categories:
  - 个人研究
  - 技术美术
  - 光照模拟
abbrlink: 3105478131
---
# 【技术美术】双向透射分布函数

主流的光照模型基于反射，反射分漫反射和镜面反射，透射也是一样。漫透射是指透射光穿越介质时经过了多次弹射，而镜透射则是未经弹射，直接由折射一次性射出。不过透射部分，很少见网上讲，因此只能根据个人经验进行推测了。

## 漫透射

首先从双向反射分布函数考虑，“漫反射”和“镜反射”中，“镜反射”是一次接触直接反射，故肯定不会进入物体内部，但“漫反射”是在物体内部多次弹射的结果，因此显然他是可能发生“漫透射”的，因此可以确定，“漫透射”的光，是从“漫反射”中分来的。就像“漫反射”和“镜反射”有金属度进行权重分配一样，那“漫反射”和“漫透射”之间的光能权重分配，也需要一个属性，就叫它“透射率”吧。

```hlsl
//直接漫射
float diffuseTerm = max(0.0f, dot(light.direction, normalWS));
float3 diffuseLightTerm = light.color * light.distanceAttenuation * light.shadowAttenuation;
color += diffuseTerm * diffuseLightTerm * (1 - _Transmittivity);

//直接透射
float3 backLightDir = -normalize(light.direction + fragment.normalWS * _Disturbance);
float transmitTerm = saturate((dot(backLightDir, viewDirWS) + _Range) / (1 + _Range));
transmitTerm = pow(transmitTerm, _Power) * _Scale;
float3 transmitLightTerm = light.color * light.distanceAttenuation;
float thickness = tex2D(_Thickness, fragment.texcoord);
color += transmitTerm * transmitLightTerm * thickness * _Transmittivity;
```

## 镜透射

仅透射约等于透明，不考虑光照物理的话，有两种方法：

1. 把背景图保存下，直接用折射采样就行（类似于环境镜射光用反射采样环境贴图）。
2. 直接给物体搞个半透明材质。

# 【数学】微分

## 定义

函数的微分又叫导数。函数$f(x)$的导数定义如下：

$$
f'(x)=\lim_{\Delta{x} \to 0}\frac{ f(x+\Delta x)-f(x)}{\Delta x}
$$

或者也可以记作如下形式（莱布尼茲记法）：

$$
\frac{d f(x)}{dx}=\frac{ f(x + dx) - f(x) } {dx}
$$

注意！$\frac{d f(x)}{dx}$中的$f(x)$不放在分号上也可以，替换成 y 表示也可以。并且其中的 $dy$，$dx$ 都是参数而不是符号，本质都是一个未知增量值，这意味它们是可以参与运算和变形的。

## 计算

求解函数导数的过程叫做“微分法”。利用定义中的公式可以很容易的计算，例如下面计算$\frac{d}{dx}x^2$。

$
\begin{aligned}
\frac{d}{dx}x^2 
&= \lim_{\Delta{x} \to 0} \frac{(x+\Delta x)^2-x^2}{\Delta x} \\
&= \lim_{\Delta{x} \to 0} \frac{x^2+2x \Delta{x}+\Delta{x}^2 - x^2}{\Delta x}\\
&= \lim_{\Delta{x} \to 0} \frac{2x\Delta{x}+\Delta{x}^2}{\Delta x}\\
&= \lim_{\Delta{x} \to 0} 2x+\Delta{x}\\
&= 2x
\end{aligned}
$

利用此方法便可以学会自行求解导数，或者也可以直接查找导数列表来获得已计算的常用导数：  
https://www.shuxuele.com/calculus/derivatives-rules.html

### 求导法则

虽然可以利用导数列表快速求解导数，但要注意的是，导数计算并不总是满足分配律的，因此必须要学会求导法则，将函数拆解后再确认可用的导数列表项。

- 乘以常数：$(cf)'=cf'$
- 幂次方法则：$(x^n)'=nx^{n-1}$
- 加法（和）法则：$(f+g)'=f'+g'$
- 减法（差）法则：$(f-g)'=f'-g'$
- 乘法（积）法则：$(fg)'=f'g + fg'$
- 除法（商）法则：$(\frac{f}{g})'= \frac{f'g-fg'}{g^2}$
- 倒数法则：$(\frac{1}{f})'=\frac{-f'}{f^2}$
- 链式法则：$(f(g))' = f'(g)g'$

链式法则还支持另一种记法：

$$
\frac{dy}{dx}=\frac{dy}{du}\frac{du}{dx}
$$

其中$u=f(x),y=f(u)$。相当于先将关于 x 的一部分表达式看成一个完整的自变量（即将其视作 x，因此求导法则也发生变换），以便适配导数列表中的公式来求导，最后再乘上该自变量的实际导数来获取最终结果。

例如求解$\frac{d}{dx}\sin(x^2)$：

1. 设 $x^2=u$，则 $\sin(u)'=\cos(u)$。
2. 而实际 u 的导数为 $(x^2)'=2x$。
3. 两者相乘得 $2x\cos(u)$。
4. 最后还原 u 得到最终结果：$\frac{d\sin(x^2)}{dx}=2x\cos(x^2)$

### 隐微分法

隐函数一种特殊类型的函数，求解隐函数的导数有两种方法：

1. 转为显函数再求导 $\frac{dy}{dx}$（但有些函数的显函数形式很难求导，甚至不可能）。
2. 对两边直接求导 $\frac{df(x)}{dx}$（此处$f(x) \ne y$，仅代表两边式子），再求解计算过程中出现的 $\frac{dy}{dx}$ 的值。

例如对函数 $10x^4 - 18xy^2 + 10y^3 = 48$ 中由 x 组成的 y 的显函数求导。由于 $y=f(x)$ 的显函数形式无法列出，故采用方法 2 直接两边求导。

$
\begin{aligned}
\frac{d}{dx}(10x^4 - 18xy^2 + 10y^3) &= \frac{d}{dx}(48)\\
\frac{d}{dx}(10x^4) - \frac{d}{dx}(18xy^2) + \frac{d}{dx}(10y^3) &= 0\\
40x^3 - ((18x)'y^2 + 18x(y^2)') + 30y^2(y)' &= 0\\
40x^3 - (18y^2 + 18x*2y(y)') + 30y^2(y)' &= 0\\
40x^3 - 18y^2 - 36xy(y)' + 30y^2(y)' &= 0\\
-36xy(y)' + 30y^2(y)' &= 18y^2-40x^3\\
-18xy(y)' + 15y^2(y)' &= 9y^2-20x^3\\
3(5y^2-6xy)y' &= 9y^2-20x^3\\
\frac{dy}{dx} &= \frac{ 9y^2-20x^3}{3(5y^2-6xy)}\\
\end{aligned}
$

此外隐微分法还可用于在根本不知道反函数形式的情况下，求解反函数的导数。例如求解 $\sin^{-1}$：

已知 $y=\sin^{-1}(x)$，则 $x=\sin(y)$，再对该函数求导即可：

$
\begin{aligned}
\frac{d}{dx}x &= \frac{d}{dx}\sin(y)\\
1 &= \cos(y)\frac{dy}{dx}\\
\frac{dy}{dx} &= \frac{1}{\cos(y)}\\
\frac{dy}{dx} &= \frac{1}{\sqrt{1-\sin^2(y)}} （基于三角函数 cos^2(x)+sin^2(x)=1 的变形）\\
\frac{dy}{dx} &= \frac{1}{\sqrt{1-x^2}}（带入 x=\sin(y)）\\
\end{aligned}
$

#### 隐微分法的作用

1. 因为隐微分法解除的导数通常带有 y 值，因此这种导数可以用于获取一个 x 有多种 y 值函数的坡度，例如圆形公式。
2. 很多函数无法直接求解，但利用隐微分法可以方便的求出它们的导数，再借助导数我们便可以推测出这些函数的大致情况。

## 二次导数

也即导数的导数，记作：

$$
f''(x)=\frac{d^2f(x)}{dx^2}=\frac{d}{dx}\frac{d(fx)}{dx}
$$

## 可微分

函数可微分表示该函数存在导数。而有些函数是没有导数的，例如：

- $|x|$不可微分，因为左右极限不同。
- $\lfloor x \rfloor$和$\lceil x \rceil$不可微分，因为整数值之间不连续。
- 当 $x=0$ 时 $x^{\frac{1}{2}}$ 不可微分，因为函数是未定义的（除 0）。

但要注意的时，如果规定了定义域，部分函数也将可微。

可微的函数就可以用微积分处理，同时函数可微表明该函数是连续的。

## 求解极值

极值是局部（部分定义域）的最值，最值是一个函数的最大或最小值（全部定义域）。

导数可用于求解极值，因为函数的极值处恰好是坡度（函数值增减方向）改变的时候，从极限的角度来看，此处的函数图像是平坦的，所以其导数为 0。

### 判断极大或极小

利用二次导数，通过导数的变化方向就可猜出当前的极值是极大还是极小：

- 小于 0：导数图像开始下降，说明函数值之前是上升，现在值下降，所以是极大值。
- 大于 0：导数图像开始上升，说明函数值之前是下降，现在值上升，所以是极小值。
- 等于 0：该检测方法无法检测，一般表明是鞍点（函数图像平坦，但不是极值）。

## 求解上凹下凹和拐点

上凹（也称下凸或凸）和下凹（也称上凸或凹）是两种函数特征。函数图形成碗装，凹槽朝上叫上凹，朝下叫下凹。而在上凹（下凹）变成下凹（上凹）的一个点叫拐点。

将一个凹两边的拐点相连成直线，上凹区间的函数值永远小于该直线，下凹则是永远大于，而这便是上凹和下凹的定义：

$$
上凹： f(ta+(1-t)b) \leq tf(a)+(1-t)f(b)
$$

$$
下凹： f(ta+(1-t)b) \geq tf(a)+(1-t)f(b)
$$

其中 $ta+(1-t)b$ 表示 a 到 b 区间的任意值，其中 t 为 0-1 的实数。

### 利用导数判断凹的方向

导数就是函数图形的坡度，而坡度变换也能反映函数的凹方向：

- 若导数连续增大，函数是上凹。
- 若导数连续减小，函数是下凹。

也即：

- 若二阶导数是正数，函数是上凹。
- 若二阶导数是负数，函数是下凹。

## 泰勒级数

泰勒级数是一种展开函数的方式，可用于将一些无法直接求解的函数转化为无穷个可以简单求解的分量的累加，从而选择性的获取与原近似的结果。一个函数的泰勒级数展开方式如下：

$$
f(x)=f(x_0)+\frac{f'(x_0)}{1!}(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+\frac{f'''(x_0)}{3!}(x-x_0)^3 +\dots
$$

其中 $x_0$ 为自定义的常值，这意味着只要知道任意 $f(x_0)$ 的结果，求可以对该函数进行泰勒展开，从而使该函数的其他值也变的可解。

特别的当 $x_0=0$ 时，被称为麦克劳林级数（当其他地方提到泰勒级数时，实际上默认为麦克劳林级数）：

$$
f(x)=f(0)+\frac{f'(0)}{1!}x+\frac{f''(0)}{2!}x^2+\frac{f'''(0)}{3!}x^3 + \dots
$$

### 求解方法

- 直接展开法：根据泰勒公式的形式直接展开目标函数的泰勒公式。
- 间接展开法：通过对已知其他函数的泰勒公式的计算来获取目标函数的泰勒公式。（如下方求$\cos$泰勒级数的备注示例）

### 常见泰勒级数

一些常见函数的泰勒级数如下：

$\displaystyle\begin{aligned}  
  e^x
  &= 1+\frac{x}{1!}+\frac{x^2}{2!}+\frac{x^3}{3!}\dots\\
  &= \sum_{n=0}^{\infin}\frac{x^n}{n!}
  \end{aligned}$

$\displaystyle\begin{aligned} 
  \sin{x}
  &=\sin{0}+\frac{\cos{0}}{1!}x+\frac{-sin{0}}{2!}x^2+\frac{-cos{0}}{3!}x^3+\frac{sin{0}}{4!}x^4+\frac{cos{0}}{5!}x^5+\dots\\
  &=x-\frac{x^3}{3!}+\frac{x^5}{5!}\dots\\
  &=\sum_{n=0}^{\infin}(-1)^n\frac{x^{2n+1}}{(2n+1)!}\\
  \end{aligned}$

$\displaystyle\begin{aligned}
\cos{x}
&=\cos{0}+\frac{-\sin{0}}{1!}x+\frac{-cos{0}}{2!}x^2+\frac{sin{0}}{3!}x^3+\frac{cos{0}}{4!}x^4+\frac{-sin{0}}{5!}x^5+\dots\\
&=1-\frac{x^2}{2!}+\frac{x^4}{4!}+\dots\\
&=\sum_{n=0}^{\infin}(-1)^n\frac{x^{2n}}{(2n)!}\
\end{aligned}$

- 备注：$\cos$ 的泰勒公式也可用间接法求：

  $
  \because \sin'{x}=\cos{x}\\
  \begin{aligned}
  \therefore \cos{x}
  &=\frac{d}{dx}\sum_{n=0}^{\infin}(-1)^n\frac{x^{2n+1}}{(2n+1)!}\\
  &=\sum_{n=0}^{\infin}(-1)^n\frac{(2n+1)x^{2n}}{(2n+1)(2n)!}\\
  &=\sum_{n=0}^{\infin}(-1)^n\frac{x^{2n}}{(2n)!}\\
  \end{aligned}
  $

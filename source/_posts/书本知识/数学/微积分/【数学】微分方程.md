---
categories:
  - 书本知识
  - 数学
  - 微积分
abbrlink: 1881172680
---

# 【数学】微分方程

## 定义

微分方程一种特别的形式的方程，这种方程中同时拥有一个函数（也可以理解为因变量）以及该函数的导数。以下两种形式的方程都可以称作微分方程：

$$
\frac{dy}{dx}=x+y \iff f'(x)=x+f(x)
$$

微分方程表明 y 与 x 之间的变化关系不仅与 x 有关，还与 y 自身的值也有关，也即 y 自己也会影响自己的值。因此微分方程就是用于形容这些会变化的关系，例如生物繁殖，存款利滚利，温度变化等各种现实常见现象。

### 分类

微分方程有几种分类：

- 常微分方程：微分方程中只有一个自变量。（如 $y=y'+x$ 中只有 x 一个自变量）
- 偏微分方程：微分方程有两个或以上的自变量。

### 属性

此外还有些用于描述微分方程的属性：

- 阶数：微分方程中最高的导数阶数。
- 次数：微分方程中最高阶导数的次数。
- 线性：微分方程中因变量及其导数只被线性运算过。（即不存在 $y^2$，$\sin(y)$ 等）

## 求解微分方程

求解微分方程非常困难，甚至无法求解，但对一些特定形式的微分方程，是有求解办法的。

### 分离变量法

当所有 y 项（包括 dy）和所有 x 项（包括 dx）可以分别放在等式两边的时候，可以使用分离变量法求解：

1. 先分离 y 项和 x 项到等式两边。
2. 对两边积分（由于微分被拆解，两边各有 dxdy，故支持积分运算）。
3. 化简得出最终结果（如合并积分常数，变形为显函数）。

如求解如下公式：

$
\begin{aligned}
\frac{dy}{dx} &= \frac{2xy}{1+x^2} \\
\frac{1}{y}dy &= \frac{2x}{1+x^2}dx  \\
\int\frac{1}{y}dy &= \int\frac{2x}{1+x^2}dx  \\
\int\frac{1}{y}dy &= \int\frac{1}{u}du|_{u=1+x^2}  \\
\ln{y}+E &= \ln(1+x^2) +F  \\
\ln{y} &= \ln(1+x^2) +C|_{C=F-E}  \\
\ln{y} &= \ln(1+x^2) + \ln k|_{k^C=e}  \\
\ln{y} &= \ln(k(1+x^2))   \\
y &= k(1+x^2)
\end{aligned}
$

这样便得到了 y 与 x 的关系式，带入任意 x 都可以立即得到 y。

### 数值求解法

通过求解函数在若干离散点的近似值后，再拟合成曲线，用该曲线实现计算近似值计算。

#### 分类

按计算次数分：

- 单步法：计算 $y_{i+1}$ 时，只用到了前面的一个近似值 $y_{i}$
- 多步法：计算 $y_{i+1}$ 时，用到了前面的多个近似值 $y_{i}$、$y_{i-1}$、$y_{i-2}$ ......

按计算公式形式分：

- 隐式法：方程两端均有 $y_{i+1}$，难以合入一段，需先求解隐函数方程才能求解 $y_{i+1}$.
- 显式法：方程可以直接求出 $y_{i+1}$。

### 欧拉法

显式欧拉是一种数值求解法，又叫欧拉折线法，因为他的计算过程就像是通过一条折现不断去逼近结果。折现的长度叫步幅，本质就是 $\Delta x$；折现的方向就是函数变化率，即 $\frac{dx}{dy}$。

#### 显式欧拉

$$y_{i+1}=y_{i}+hf'(x_i)$$

- h：步幅

例如求解 $y = e^x|_{x=0.2}$ 的值：

设 $h=0.1$，$y_1 = e^0 = 1$，则 $e^{0.2}=y_3$

$
\begin{aligned}
y_2 &=y_1+hy'_1=1+0.1*e^0=1.1\\
y_3 &=y_2+hy'_2=1.1+0.1*e^{0.1}=1.21（y_2=e^{0.1}=y'_2）
\end{aligned}
$

故 $e^{0.2} \approx 1.21$

#### 半隐式欧拉

当不知道 $y_{i+1}$ 等于多少，但知道 $y'_{i+1}$ 时，可以用半隐式欧拉，比显式欧拉精度高点，又没有隐式欧拉那么难解。

$$y_{i+1}=y_{i}+hf'(x_{i+1})$$
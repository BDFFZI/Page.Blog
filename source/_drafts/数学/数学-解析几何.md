---
categories:
  - 1. 学习
  - 数学
---
# 直线
## 构成
```
float3 Origin;
float3 Normal;
```
## 定义
```
float3 p;//射线上任意一点
float t;//上述任意点到射线原点的距离
Origin + Normal * t = p;
//参数方程
float x = p.x,y = p.y,z = p.z;
float Ox = Origin.x;
float Oy = Origin.y;
float Oz = Origin.z;
float Nx = Normal.x;
float Ny = Normal.y;
float Nz = Normal.z;
(x - Ox) / Nx = (y - Oy) / Ny = (z - Oz) / Nz
```

# 平面
## 构成
```
float3 Origin;
float3 Normal;
```
## 定义
```
float3 p;//平面上任意一点
Dot(p - Origin,Normal) = 0;
//参数方程
Dot(p,Normal)-Dot(Origin,Normal) = 0
float x = p.x,y = p.y,z = p.z;
float A = Normal.x;
float B = Normal.x;
float C = Normal.x;
float D = -Dot(Origin,Normal);
Ax + By + Cz + D = 0;
```

# 三角面
## 构成
```
float3 p0,p1,p2;
```
## 面积计算
```
    p1
  -     -
p0-------p2

公式：S = 1/2 * 底 * 高
变形：S = 1/2 * 底 * 斜 * Sin(θ)
其中：
底 = Length(p2-p0)
斜 = Length(p1-p0)
θ = Angle(p2-p0,p1-p0);
```

# 相交测试
## 直线和平面
```
Line //直线
Plane //平面
```
### 计算交点
#### 结论：
- 交点 = Line.Origin + Line.Normal * Dot(Plane.Origin - Line.Origin,Plane.Normal) / Dot(Line.Normal,Plane.Normal)；
- 其中Dot(Line.Normal,Plane.Normal)不能等于0
#### 过程
```
float3 p; //设存在同时位于直线和平面上的点p
float3 t; //设t为p点距离直线原点的长度

//带入直线定义公式可得
p = Line.Origin + Line.Normal * t;
//进一步带入到平面公式可得
Dot(
    (Line.Origin + Line.Normal * t) - Plane.Origin,
    Plane.Normal
) = 0;

//根据Dot结合律拆分公式
Dot(Line.Origin,Plane.Normal) +
Dot(Line.Normal * t,Plane.Normal) -
Dot(Plane.Origin,Plane.Normal) = 0;
//调换常数部分到右侧，并化简Dot函数
Dot(Line.Normal,Plane.Normal) * t = Dot(Plane.Origin - Line.Origin,Plane.Normal);

//化简出t的计算公式(可见Line.Normal和Plane.Normal不能垂直，否则会除以0)
t = Dot(Plane.Origin - Line.Origin,Plane.Normal) / Dot(Line.Normal,Plane.Normal)
//计算出结果
p = Line.Origin + Line.Normal * t
```